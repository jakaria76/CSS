@model List<CSS.Models.Video>
@{
    ViewData["Title"] = "Video Management";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />

<style>
    .video-header {
        background: linear-gradient(90deg, #203a93, #4a7fff);
        padding: 15px 20px;
        color: white;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .video-table th {
        background: #eef3ff;
        font-weight: 700;
        padding: 14px;
        font-size: 15px;
    }

    .video-table td {
        padding: 12px;
        vertical-align: middle;
        font-size: 15px;
    }

    .video-table tr:hover {
        background-color: #f5f8ff;
    }

    .action-btn {
        padding: 5px 12px;
        font-size: 14px;
        border-radius: 6px;
    }

    .truncate-url {
        max-width: 350px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
    }
</style>

<div class="video-header">
    <h4 class="m-0"><i class="bi bi-collection-play-fill"></i> Video Management</h4>
    <a asp-action="Create" class="btn btn-light fw-bold">
        <i class="bi bi-plus-circle"></i> Add New Video
    </a>
</div>

<table class="table table-bordered video-table">
    <thead>
        <tr>
            <th style="width:60px;">ID</th>
            <th>Title</th>
            <th>YouTube URL</th>
            <th style="width:100px;">Sort</th>
            <th style="width:160px;">Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var v in Model)
        {
            <tr>
                <td>@v.Id</td>
                <td>@v.Title</td>

                <td>
                    <span class="truncate-url">@v.YouTubeUrl</span>
                </td>

                <td>@v.SortOrder</td>

                <td>
                    <a asp-action="Edit" asp-route-id="@v.Id" class="btn btn-primary btn-sm action-btn">
                        <i class="bi bi-pencil-square"></i> Edit
                    </a>

                    <button type="button"
                            class="btn btn-danger btn-sm action-btn"
                            onclick="confirmDelete(@v.Id)">
                        <i class="bi bi-trash3"></i> Delete
                    </button>
                </td>
            </tr>
        }
    </tbody>
</table>

<!-- Hidden Delete Form -->
<form id="deleteForm" method="post" style="display:none;">
    <input type="hidden" id="deleteId" name="id" />
    @Html.AntiForgeryToken()
</form>

<!-- SweetAlert Script -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    function confirmDelete(id) {
        Swal.fire({
            title: "Are you sure?",
            text: "This video will be permanently deleted!",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#d33",
            cancelButtonColor: "#3085d6",
            confirmButtonText: "Yes, Delete!",
            cancelButtonText: "Cancel"
        }).then((result) => {
            if (result.isConfirmed) {

                // Set ID in hidden field
                document.getElementById("deleteId").value = id;

                // Set form action
                document.getElementById("deleteForm").action = "/VideoManagement/Delete/" + id;

                // Submit form
                document.getElementById("deleteForm").submit();
            }
        });
    }
</script>
