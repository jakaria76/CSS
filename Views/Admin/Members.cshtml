@model List<CSS.Models.ApplicationUser>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
    /* HEADER */
    .page-header {
        background: linear-gradient(to right, #1a237e, #3949ab);
        padding: 18px;
        border-radius: 12px;
        color: white;
        text-align: center;
        margin-bottom: 25px;
        box-shadow: 0 5px 18px rgba(0,0,0,0.18);
    }

    .search-box input {
        border-radius: 10px;
        padding: 12px;
        border: 2px solid #3949ab;
    }

    .btn-add {
        background: #1a237e;
        border: none;
        color: white;
        padding: 10px 18px;
        font-weight: 600;
        border-radius: 8px;
        transition: 0.2s;
    }

        .btn-add:hover {
            background: #0c1548;
            color: white;
        }

    .table-container {
        border-radius: 14px;
        overflow-x: auto;
        overflow-y: hidden;
        box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        padding-bottom: 5px;
    }

    thead {
        background: #e8eaf6 !important;
        color: #1a237e;
        font-size: 1rem;
        font-weight: 600;
    }

    tbody tr:hover {
        background: #f4f6ff;
        transition: 0.2s;
    }

    .badge-type {
        background: #3949ab;
        padding: 6px 10px;
        border-radius: 6px;
        color: white;
        font-size: 0.85rem;
    }

    .btn-sm {
        font-size: 0.8rem;
        padding: 6px 10px;
        border-radius: 6px;
        white-space: nowrap;
    }

    .btn-edit {
        background: #1565c0;
        color: white;
    }

        .btn-edit:hover {
            background: #0d47a1;
            color: white;
        }

    .btn-position {
        background: #ffb300;
        color: black;
    }

        .btn-position:hover {
            background: #ffa000;
        }

    .btn-del {
        background: #d32f2f;
        color: white;
    }

        .btn-del:hover {
            background: #b71c1c;
        }

    /* Responsive */
    @@media (max-width: 576px) {
        table

    {
        font-size: 0.85rem;
    }

    .btn-add {
        width: 100%;
        margin-bottom: 10px;
    }

    }
</style>


<div class="container mt-4">

    <!-- HEADER -->
    <div class="page-header">
        <h3 class="m-0"><i class="fa-solid fa-users-gear"></i> Manage Members</h3>
    </div>

    <!-- SEARCH -->
    <form class="mb-3 search-box" method="get">
        <input type="text" name="q" value="@ViewBag.Query" class="form-control" placeholder="Search by name, email, phone, position..." />
    </form>

    <a asp-action="Create" class="btn-add mb-3 d-inline-block">
        <i class="fa fa-user-plus"></i> Add New Member
    </a>

    <!-- TABLE -->
    <div class="table-container">
        <table class="table table-hover table-bordered align-middle text-nowrap">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Mobile</th>
                    <th>Alternative Mobile</th>
                    <th>Member Type</th>
                    <th>Committee Position</th>
                    <th width="200px">Actions</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var u in Model)
                {
                    <tr>
                        <td><strong>@u.FullName</strong></td>
                        <td>@u.Email</td>
                        <td>@(u.PhoneNumber ?? "N/A")</td>
                        <td>@(u.AlternativeMobile ?? "N/A")</td>
                        <td><span class="badge-type">@u.MemberType</span></td>
                        <td>@u.CommitteePosition</td>

                        <td>
                            <div class="d-flex gap-1">

                                <a asp-action="Edit" asp-route-id="@u.Id" class="btn btn-sm btn-edit">
                                    <i class="fa-solid fa-pen"></i> Edit
                                </a>

                                <a asp-action="EditPosition" asp-route-id="@u.Id" class="btn btn-sm btn-position">
                                    <i class="fa-solid fa-user-tag"></i> Position
                                </a>

                                <!-- SWEETALERT DELETE BUTTON -->
                                <button type="button" class="btn btn-sm btn-del"
                                        onclick="deleteUser('@u.Id', '@u.FullName')">
                                    <i class="fa-solid fa-trash"></i>
                                </button>

                            </div>
                        </td>

                    </tr>
                }
            </tbody>

        </table>
    </div>

</div>


<!-- SWEETALERT DELETE SCRIPT -->
<script>
    function deleteUser(id, name) {

        Swal.fire({
            title: "Are you sure?",
            html: "Delete <b>" + name + "</b> permanently?",
            icon: "warning",
            showCancelButton: true,
            confirmButtonColor: "#d33",
            cancelButtonColor: "#3085d6",
            confirmButtonText: "Yes, Delete",
            cancelButtonText: "Cancel"
        }).then((result) => {
            if (result.isConfirmed) {

                // Create a form dynamically to submit POST request
                var form = document.createElement("form");
                form.method = "post";
                form.action = "/Admin/Delete";

                var input = document.createElement("input");
                input.type = "hidden";
                input.name = "id";
                input.value = id;

                form.appendChild(input);
                document.body.appendChild(form);
                form.submit();
            }
        });
    }
</script>
