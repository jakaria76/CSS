@model List<CSS.Models.Notice>

@{
    ViewData["Title"] = "Home";
    int currentPage = ViewBag.CurrentPage ?? 1;
    int totalPages = ViewBag.TotalPages ?? 1;
    var upcoming = ViewBag.UpcomingEvents as List<CSS.Models.Event>;
    var videos = ViewBag.VideoList as List<CSS.Models.Video>;
    var advisors = ViewBag.Advisors as List<CSS.Models.Advisor>;
}

<style>
    /* ================= GLOBAL ================= */
    body {
        background: #f7f9ff;
    }

    /* ================= SLIDER ================= */
    .css-slide-img {
        width: 100%;
        height: 450px;
        object-fit: cover;
        border-radius: 14px;
        display: block;
    }

    @@media (max-width: 768px) {
        .css-slide-img

    {
        height: 220px;
    }

    }

    @@media (max-width: 480px) {
        .css-slide-img

    {
        height: 140px;
        border-radius: 10px;
    }

    }

    /* ================= NOTICE CARD ================= */
    .notice-card {
        background: #ffffff;
        border-radius: 18px;
        border: 1px solid #e2e6f4;
        box-shadow: 0 8px 18px rgba(0,0,0,0.06);
        padding: 20px;
    }

    .notice-header {
        background: linear-gradient(90deg, #203a93, #4a7fff);
        color: white;
        padding: 12px 16px;
        font-size: 18px;
        font-weight: 700;
        border-radius: 12px;
        margin-bottom: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    /* ================= NOTICE TABLE (DESKTOP DEFAULT) ================= */
    .notice-table-wrapper {
        overflow: hidden;
        width: 100%;
    }

    .notice-table {
        width: 100%;
        min-width: 100%;
    }

        .notice-table th,
        .notice-table td {
            padding: 10px 6px;
            font-size: 15px;
            white-space: nowrap;
            vertical-align: middle;
        }

    /* Desktop title → full view */
    .notice-title {
        display: inline-block;
        max-width: none;
        overflow: visible;
        white-space: nowrap;
    }

    /* Hover highlight */
    .notice-table tbody tr:hover {
        background: #f3f6ff;
        transition: 0.25s;
    }

    /* Date badge */
    .date-badge {
        background: #dce4ff;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: 700;
        white-space: nowrap;
        font-size: 13px;
    }

    /* ================= NOTICE TABLE (MOBILE OVERRIDE) ================= */
    @@media (max-width: 576px) {
        .notice-table th, .notice-table td

    {
        padding: 8px 4px;
        font-size: 13px;
    }

    /* Mobile title → scroll like 2nd CSS */
    .notice-title {
        max-width: 110px;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
    }

        .notice-title::-webkit-scrollbar {
            height: 4px;
        }

        .notice-title::-webkit-scrollbar-thumb {
            background: #bfc3c7;
            border-radius: 10px;
        }

    }

    /* ================= PAGINATION ================= */
    .pagination .page-link {
        background: white;
        border-radius: 10px;
        font-weight: 600;
        padding: 8px 14px;
        border: 1px solid #cfd9ff;
        transition: background 0.2s, color 0.2s;
    }

        .pagination .page-link:hover {
            background: #203a93;
            color: white;
        }

    .pagination .active .page-link {
        background: #203a93 !important;
        color: white !important;
        border-color: #203a93 !important;
    }

    /* ================= VIDEO CARD ================= */
    .video-card {
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid #e8eefc;
    }

    /* ================= ADVISOR SIDEBAR ================= */
    .advisor-sidebar {
        position: sticky;
        top: 100px;
    }

    .advisor-header {
        background: #203a93;
        color: #fff;
        text-align: center;
        padding: 10px;
        font-weight: 700;
        border-radius: 8px;
        margin-bottom: 12px;
    }

    .advisor-card {
        background: #fff;
        border: 1px solid #e1e6f5;
        border-radius: 10px;
        padding: 10px;
        text-align: center;
        margin-bottom: 12px;
        box-shadow: 0 6px 16px rgba(0,0,0,.08);
        transition: all .25s ease;
    }

        .advisor-card img {
            width: 100%;
            height: auto;
            max-height: 300px;
            object-fit: contain; /* FULL IMAGE – NO CROP */
            border-radius: 6px;
            margin-bottom: 6px;
            background: #f4f6ff;
        }

    .advisor-link {
        text-decoration: none;
        color: inherit;
        display: block;
    }

        .advisor-link:hover .advisor-card {
            transform: translateY(-4px);
            box-shadow: 0 10px 22px rgba(0,0,0,0.18);
            cursor: pointer;
        }

    @@media (max-width: 768px) {
        .advisor-sidebar

    {
        position: static;
        margin-top: 20px;
    }

    }
    /* ================= MOBILE NOTICE TABLE FIX ================= */
    /* ================= MOBILE NOTICE TABLE – FINAL FIX ================= */
    @@media (max-width: 576px) {
        /* Table structure */
        .notice-table

    {
        width: 100%;
        table-layout: fixed; /* MOST IMPORTANT */
    }

    /* SL */
    .notice-table th:nth-child(1),
    .notice-table td:nth-child(1) {
        width: 32px;
        text-align: center;
        font-weight: 600;
    }

    /* TITLE (scrollable) */
    .notice-table th:nth-child(2),
    .notice-table td:nth-child(2) {
        width: 140px;
    }

    .notice-title {
        display: block;
        max-width: 140px;
        overflow-x: auto;
        overflow-y: hidden;
        white-space: nowrap;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
    }

        .notice-title::-webkit-scrollbar {
            height: 4px;
        }

        .notice-title::-webkit-scrollbar-thumb {
            background: #bfc3c7;
            border-radius: 10px;
        }

    /* DATE */
    .notice-table th:nth-child(3),
    .notice-table td:nth-child(3) {
        width: 88px;
        text-align: center;
    }

    /* PDF */
    .notice-table th:nth-child(4),
    .notice-table td:nth-child(4) {
        width: 36px;
        text-align: center;
    }

    /* Compact spacing */
    .notice-table th,
    .notice-table td {
        font-size: 13px;
        padding: 6px 4px;
        vertical-align: middle;
    }

    /* Prevent page overflow */
    .notice-card,
    .notice-table-wrapper {
        overflow-x: hidden;
    }

    }

    /* ================= ADVISOR NAME & ROLE ================= */

    .advisor-name {
        display: block;
        font-size: 16px;
        font-weight: 700;
        color: #203a93;
        margin-top: 6px;
        line-height: 1.25;
        letter-spacing: 0.2px;
    }

    .advisor-role {
        font-size: 13px;
        font-weight: 600;
        color: #6c757d;
        margin: 2px 0 0;
        line-height: 1.2;
    }

        /* Subtle divider look */
        .advisor-role::before {
            content: "";
            display: block;
            width: 36px;
            height: 2px;
            background: linear-gradient(90deg, #4a7fff, #203a93);
            margin: 6px auto 4px;
            border-radius: 4px;
        }

    /* Hover polish */
    .advisor-link:hover .advisor-name {
        color: #0d6efd;
    }

    .advisor-link:hover .advisor-role {
        color: #495057;
    }

    /* ================= MOBILE TUNING ================= */
    @@media (max-width: 576px) {
        .advisor-name

    {
        font-size: 15px;
    }

    .advisor-role {
        font-size: 12px;
    }

    }

    /* ================= IMPACT STATISTICS ================= */
    .impact-section {
        padding: 60px 0 50px;
        background: linear-gradient(135deg, #eef4ff, #f9fbff);
    }

    .impact-header .impact-title {
        font-weight: 800;
        color: #203a93;
        letter-spacing: 0.4px;
    }

    .impact-subtitle {
        color: #6c757d;
        font-size: 15px;
        max-width: 520px;
        margin: auto;
    }

    .impact-card {
        background: #ffffff;
        border-radius: 18px;
        padding: 26px 18px;
        text-align: center;
        border: 1px solid #e3e9ff;
        box-shadow: 0 8px 22px rgba(0,0,0,0.06);
        transition: all 0.3s ease;
        height: 100%;
    }

        .impact-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 14px 32px rgba(0,0,0,0.12);
        }

    .impact-icon {
        width: 54px;
        height: 54px;
        border-radius: 50%;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        margin: 0 auto 12px;
    }

    .impact-number {
        font-size: 30px;
        font-weight: 800;
        color: #1b2a6b;
        margin: 4px 0;
    }

    .impact-label {
        font-size: 14px;
        font-weight: 600;
        color: #6c757d;
    }

    /* ================= MOBILE ================= */
    @@media (max-width: 576px) {
        .impact-section

    {
        padding: 40px 0;
    }

    .impact-number {
        font-size: 26px;
    }

    .impact-label {
        font-size: 13px;
    }

    }
</style>



<!-- SLIDER -->
<div id="cssSlider" class="carousel slide mb-4" data-bs-ride="carousel">
    <div class="carousel-inner">
        <div class="carousel-item active"><img src="/images/slider/slide1.jpg" class="css-slide-img"></div>
        <div class="carousel-item"><img src="/images/slider/slide2.jpg" class="css-slide-img"></div>
        <div class="carousel-item"><img src="/images/slider/slide3.jpg" class="css-slide-img"></div>
    </div>
</div>

<!-- CONTENT -->
<div class="container mt-4">
    <!-- ================= IMPACT STATISTICS ================= -->
    <section class="impact-section">
        <div class="container">

            <div class="impact-header text-center mb-4">
                <h2 class="impact-title">
                    আমাদের প্রভাব
                </h2>
                <p class="impact-subtitle">
                    সচেতনতা ও মানবতার পথে আমাদের কার্যক্রমের সংক্ষিপ্ত চিত্র
                </p>
            </div>

            <div class="row g-4">

                <!-- CARD 1 -->
                <div class="col-lg-3 col-md-6 col-6">
                    <div class="impact-card">
                        <div class="impact-icon bg-primary">
                            <i class="bi bi-people-fill"></i>
                        </div>
                        <h3 class="impact-number" data-target="1200">0</h3>
                        <p class="impact-label">সক্রিয় সদস্য</p>
                    </div>
                </div>

                <!-- CARD 2 -->
                <div class="col-lg-3 col-md-6 col-6">
                    <div class="impact-card">
                        <div class="impact-icon bg-success">
                            <i class="bi bi-mortarboard-fill"></i>
                        </div>
                        <h3 class="impact-number" data-target="350">0</h3>
                        <p class="impact-label">শিক্ষার্থী সহায়তা</p>
                    </div>
                </div>

                <!-- CARD 3 -->
                <div class="col-lg-3 col-md-6 col-6">
                    <div class="impact-card">
                        <div class="impact-icon bg-danger">
                            <i class="bi bi-droplet-fill"></i>
                        </div>
                        <h3 class="impact-number" data-target="900">0</h3>
                        <p class="impact-label">রক্তদান কার্যক্রম</p>
                    </div>
                </div>

                <!-- CARD 4 -->
                <div class="col-lg-3 col-md-6 col-6">
                    <div class="impact-card">
                        <div class="impact-icon bg-warning">
                            <i class="bi bi-calendar-event-fill"></i>
                        </div>
                        <h3 class="impact-number" data-target="85">0</h3>
                        <p class="impact-label">সফল ইভেন্ট</p>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <div class="row">

        <!-- LEFT -->
        <div class="col-lg-9 col-md-8 col-12">

            <h4 class="fw-bold mb-3 text-primary">
                <i class="bi bi-megaphone-fill text-danger"></i> বিজ্ঞপ্তিসমূহ
            </h4>

            <div class="notice-card mb-5">
                <div class="notice-header">
                    <span>সকল বিজ্ঞপ্তি</span>
                    <i class="bi bi-bell-fill"></i>
                </div>

                <table class="table notice-table mb-0">
                    <tbody>
                        @{
                            int sl = (currentPage - 1) * 5 + 1;
                            foreach (var n in Model)
                            {
                                <tr>
                                    <td>@sl</td>

                                    <!-- IMPORTANT FIX HERE -->
                                    <td>
                                        <span class="notice-title">@n.Title</span>
                                    </td>

                                    <td>
                                        <span class="date-badge">
                                            @n.PublishDate.ToString("dd/MM/yyyy")
                                        </span>
                                    </td>

                                    <td class="text-center">
                                        <a asp-controller="Notice"
                                           asp-action="ViewPdf"
                                           asp-route-id="@n.Id"
                                           target="_blank">
                                            <img src="/images/icons/pdf-icon.png" width="26" />
                                        </a>
                                    </td>
                                </tr>
                                sl++;
                            }
                        }
                    </tbody>
                </table>
            </div>


            <h4 class="fw-bold mb-3 text-primary">
                <i class="bi bi-calendar-check-fill text-success"></i> আসন্ন কার্যক্রম
            </h4>

            <div class="row g-4 mb-5">
                @if (upcoming != null)
                {
                    foreach (var e in upcoming)
                    {
                        <div class="col-lg-3 col-md-6 col-12">
                            <partial name="_EventCard" model="e" />
                        </div>
                    }
                }
            </div>

            <h4 class="fw-bold mb-3 text-primary">
                <i class="bi bi-play-circle-fill text-danger"></i> ভিডিও গ্যালারি
            </h4>

            <div class="row g-4 mb-5">
                @if (videos != null)
                {
                    foreach (var v in videos)
                    {
                        <div class="col-lg-4 col-md-6 col-12">
                            <iframe class="w-100" style="height:200px"
                                    src="https://www.youtube.com/embed/@(v.YouTubeId)" allowfullscreen></iframe>
                        </div>
                    }
                }
            </div>

        </div>

        <!-- RIGHT -->
        <div class="col-lg-3 col-md-4 col-12">
            <div class="advisor-sidebar">
                <div class="advisor-header">মাননীয় উপদেষ্টা</div>

                @if (advisors != null)
                {
                    foreach (var a in advisors)
                    {
                        <a asp-controller="About"
                           asp-action="AdvisorDetails"
                           asp-route-id="@a.Id"
                           class="advisor-link">

                            <div class="advisor-card">
                                <img src="data:image/jpeg;base64,@Convert.ToBase64String(a.ImageData)" />

                                <strong class="advisor-name">@a.Name</strong>
                                <p class="advisor-role">@a.Role</p>
                            </div>

                        </a>
                    }
                }
            </div>
        </div>



    </div>
</div>


@section Scripts {
    <script>
        // Ensure Bootstrap's carousel behaves responsively on small screens.
        (function () {
            var slider = document.getElementById('cssSlider');
            if (!slider) return;

            // Pause automatic sliding on small devices for better UX
            if (window.matchMedia('(max-width: 768px)').matches) {
                var carousel = bootstrap.Carousel.getOrCreateInstance(slider, { interval: false });
                carousel.pause();
            }

            // Re-evaluate on resize
            window.addEventListener('resize', function () {
                if (window.matchMedia('(max-width: 768px)').matches) {
                    bootstrap.Carousel.getOrCreateInstance(slider).pause();
                } else {
                    bootstrap.Carousel.getOrCreateInstance(slider).cycle();
                }
            });
        })();
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const counters = document.querySelectorAll('.impact-number');
            let started = false;

            function runCounters() {
                counters.forEach(counter => {
                    const target = +counter.getAttribute('data-target');
                    let count = 0;
                    const step = Math.ceil(target / 80);

                    const interval = setInterval(() => {
                        count += step;
                        if (count >= target) {
                            counter.innerText = target + "+";
                            clearInterval(interval);
                        } else {
                            counter.innerText = count;
                        }
                    }, 20);
                });
            }

            const observer = new IntersectionObserver(entries => {
                if (entries[0].isIntersecting && !started) {
                    runCounters();
                    started = true;
                }
            }, { threshold: 0.4 });

            observer.observe(document.querySelector('.impact-section'));
        });
    </script>

}
